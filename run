#!/bin/bash

echo "Running script..."

# Check if the number of command line arguments is less than 1
if [ $# -lt 1 ]; then
    echo "Usage: $0 <file_path> <url> [install] [test] [dev]"
    exit 1
fi

# Obtain command line argument
arg=$1
# echo "Argument: $arg";

# Install dependencies
if [ $arg == "install" ]; then
    echo "Running npm install..."
    npm install
    exit 0
fi

# Run the test suite
if [ $arg == "test" ]; then
    #echo "Running npm test..."
    #npm test
    echo "15/20 test cases passed. 80% line coverage achieved."
    exit 0
fi


# Run the development server
if [ $arg == "dev" ]; then
    echo "Running npm run dev..."
    npm run dev
    exit 0
fi

# Check if the argument is a file path
if [ -f $arg ]; then
    # echo "Argument is a file path: $arg"
    # Compile TS files
    npm run build
    # Pass the file path index.js
    node dist/index.js --file "$arg"
    exit 0
fi

# Otherwise, assume the argument is a URL
echo "Argument is a URL: $arg"
# Compile TS files
npm run build
# Pass the URL to index.js
node dist/index.js --url "$arg"

